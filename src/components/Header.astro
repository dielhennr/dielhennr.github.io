---
import { siteConfig } from "../config";

const hasProjects = siteConfig.projects && siteConfig.projects.length > 0;
const hasExperience = siteConfig.experience && siteConfig.experience.length > 0;
const hasEducation = siteConfig.education && siteConfig.education.length > 0;
---

<header
  id="header"
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300"
>
  <!-- Desktop Navigation -->
  <nav class="hidden md:block max-w-7xl mx-auto px-8 py-4">
    <ul class="flex items-center gap-8 justify-center">
      <li>
        <a
          href="#about"
          class="text-gray-300 hover:text-white transition-colors font-medium"
        >
          About
        </a>
      </li>
      {
        hasProjects && (
          <li>
            <a
              href="#projects"
              class="text-gray-300 hover:text-white transition-colors font-medium"
            >
              Projects
            </a>
          </li>
        )
      }
      {
        hasExperience && (
          <li>
            <a
              href="#experience"
              class="text-gray-300 hover:text-white transition-colors font-medium"
            >
              Experience
            </a>
          </li>
        )
      }
      {
        hasEducation && (
          <li>
            <a
              href="#education"
              class="text-gray-300 hover:text-white transition-colors font-medium"
            >
              Education
            </a>
          </li>
        )
      }
    </ul>
  </nav>

  <!-- Mobile Navigation -->
  <div class="md:hidden">
    <!-- Mobile Header Bar -->
    <div class="flex items-center justify-between px-4 py-3 bg-neutral-950/80 backdrop-blur-sm">
      <div class="text-white font-semibold text-lg">
        {siteConfig.name}
      </div>
      
      <!-- Hamburger Button -->
      <button
        id="mobile-menu-button"
        class="text-white p-2 rounded-lg hover:bg-gray-800 transition-colors"
        aria-label="Toggle mobile menu"
      >
        <svg
          id="hamburger-icon"
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"
          />
        </svg>
        <svg
          id="close-icon"
          class="w-6 h-6 hidden"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>
  </div>
</header>

<!-- Back to Top Button -->
<button
  id="back-to-top"
  class="fixed bottom-6 right-6 z-40 p-3 bg-neutral-800 text-white rounded-full shadow-lg hover:bg-neutral-700 transition-all duration-300 opacity-0 pointer-events-none transform translate-y-4"
  aria-label="Back to top"
>
  <svg
    class="w-5 h-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M5 10l7-7m0 0l7 7m-7-7v18"
    />
  </svg>
</button>

<!-- Mobile Menu Overlay (Outside Header) -->
<div
  id="mobile-menu"
  class="fixed inset-0 bg-black bg-opacity-50 z-[9999] hidden"
>
  <div class="absolute top-0 right-0 w-64 h-full bg-neutral-950 shadow-xl transform translate-x-full transition-transform duration-300">
    <div class="p-6">
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-white text-xl font-semibold">Menu</h2>
        <button
          id="mobile-menu-close"
          class="text-white p-2 rounded-lg hover:bg-gray-800 transition-colors"
          aria-label="Close mobile menu"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
      </div>

      <nav class="space-y-4">
        <a
          href="#about"
          class="block text-gray-300 hover:text-gray-100 transition-colors font-medium py-3 border-b border-gray-700"
        >
          About
        </a>
        {
          hasExperience && (
            <a
              href="#experience"
              class="block text-gray-300 hover:text-gray-100 transition-colors font-medium py-3 border-b border-gray-700"
            >
              Experience
            </a>
          )
        }
        {
          hasProjects && (
            <a
              href="#projects"
              class="block text-gray-300 hover:text-gray-100 transition-colors font-medium py-3 border-b border-gray-700"
            >
              Academic Projects
            </a>
          )
        }
        {
          hasEducation && (
            <a
              href="#education"
              class="block text-gray-300 hover:text-gray-100 transition-colors font-medium py-3 border-b border-gray-700"
            >
              Education
            </a>
          )
        }
      </nav>

      <!-- Social Links in Mobile Menu -->
      <div class="mt-8 pt-6 border-t border-gray-700">
        <h3 class="text-white text-sm font-medium mb-4">Connect</h3>
        <div class="flex gap-4">
          {
            siteConfig.social?.email && (
              <a
                href={`mailto:${siteConfig.social.email}`}
                aria-label="Email"
                class="text-gray-300 hover:text-white transition-colors"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" />
                  <path d="M3 7l9 6l9 -6" />
                </svg>
              </a>
            )
          }
          {
            siteConfig.social?.linkedin && (
              <a
                href={siteConfig.social.linkedin}
                target="_blank"
                rel="noopener noreferrer"
                aria-label="LinkedIn"
                class="text-gray-300 hover:text-white transition-colors"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M8 11v5" />
                  <path d="M8 8v.01" />
                  <path d="M12 16v-5" />
                  <path d="M16 16v-3a2 2 0 1 0 -4 0" />
                  <path d="M3 7a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v10a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4z" />
                </svg>
              </a>
            )
          }
          {
            siteConfig.social?.github && (
              <a
                href={siteConfig.social.github}
                target="_blank"
                rel="noopener noreferrer"
                aria-label="GitHub"
                class="text-gray-300 hover:text-white transition-colors"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
                </svg>
              </a>
            )
          }
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Desktop scroll behavior
  window.addEventListener("scroll", () => {
    const header = document.getElementById("header");
    if (window.scrollY > 100) {
      header?.classList.add("bg-neutral-950/80", "backdrop-blur-sm");
    } else {
      header?.classList.remove("bg-neutral-950/80", "backdrop-blur-sm");
    }
  });

  // Back to top button functionality
  window.addEventListener("scroll", () => {
    const backToTopButton = document.getElementById("back-to-top");
    if (window.scrollY > 300) {
      backToTopButton?.classList.remove("opacity-0", "pointer-events-none", "translate-y-4");
      backToTopButton?.classList.add("opacity-100", "pointer-events-auto", "translate-y-0");
    } else {
      backToTopButton?.classList.add("opacity-0", "pointer-events-none", "translate-y-4");
      backToTopButton?.classList.remove("opacity-100", "pointer-events-auto", "translate-y-0");
    }
  });

  // Back to top click handler
  document.getElementById("back-to-top")?.addEventListener("click", () => {
    window.scrollTo({
      top: 0,
      behavior: "smooth"
    });
  });

  // Mobile menu functionality
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const hamburgerIcon = document.getElementById('hamburger-icon');
    const closeIcon = document.getElementById('close-icon');
    const mobileMenuOverlay = mobileMenu?.querySelector('div');

    function openMobileMenu() {
      mobileMenu?.classList.remove('hidden');
      setTimeout(() => {
        mobileMenuOverlay?.classList.remove('translate-x-full');
      }, 10);
      hamburgerIcon?.classList.add('hidden');
      closeIcon?.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closeMobileMenu() {
      mobileMenuOverlay?.classList.add('translate-x-full');
      setTimeout(() => {
        mobileMenu?.classList.add('hidden');
      }, 300);
      hamburgerIcon?.classList.remove('hidden');
      closeIcon?.classList.add('hidden');
      document.body.style.overflow = '';
    }

    // Open menu
    mobileMenuButton?.addEventListener('click', openMobileMenu);
    
    // Close menu
    mobileMenuClose?.addEventListener('click', closeMobileMenu);
    
    // Close menu when clicking overlay
    mobileMenu?.addEventListener('click', (e) => {
      if (e.target === mobileMenu) {
        closeMobileMenu();
      }
    });

    // Close menu when clicking navigation links
    const mobileNavLinks = mobileMenu?.querySelectorAll('nav a');
    mobileNavLinks?.forEach(link => {
      link.addEventListener('click', closeMobileMenu);
    });

    // Close menu on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !mobileMenu?.classList.contains('hidden')) {
        closeMobileMenu();
      }
    });
  });
</script>

<style>
  html {
    scroll-behavior: smooth;
  }
</style>
